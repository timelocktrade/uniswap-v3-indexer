type Token {
  id: ID! # token address
  symbol: String!
  name: String!
  decimals: BigInt! @config(precision: 78) @index
  volume: BigInt!
  txCount: BigInt!
  poolCount: BigInt! @index
  swapCount: BigInt!
  mintCount: BigInt!
  burnCount: BigInt!
  positionCount: BigInt!
  lpCount: BigInt!
  tvl: BigInt!
  tokenDayData: [TokenDayData!]! @derivedFrom(field: "token")
}

type Pool {
  id: ID! # chainId-poolAddress
  address: Bytes!  
  createdAtTimestamp: Int! @index
  createdAtBlockNumber: Int! @index
  token0: Token! @index
  token1: Token! @index
  feeTier: BigInt! @index
  liquidity: BigInt!
  sqrtPriceX96: BigInt!
  currentTick: BigInt!
  observationIndex: BigInt!
  feeGrowthGlobal0X128: BigInt!
  feeGrowthGlobal1X128: BigInt!
  volume0: BigInt!
  volume1: BigInt!
  fees0: BigInt!
  fees1: BigInt!
  collected0: BigInt!
  collected1: BigInt!
  tvl0: BigInt!
  tvl1: BigInt!
  # all time number of transactions
  txCount: BigInt!
  swapCount: BigInt!
  mintCount: BigInt!
  burnCount: BigInt!
  collectCount: BigInt!
  positionCount: BigInt!
  activePositionCount: BigInt!
  lpCount: BigInt! # number of unique liquidity providers
  # hourly snapshots of pool data
  poolHourData: [PoolHourData!]! @derivedFrom(field: "pool")
  # daily snapshots of pool data
  poolDayData: [PoolDayData!]! @derivedFrom(field: "pool")
  # derived fields
  mints: [Mint!]! @derivedFrom(field: "pool")
  burns: [Burn!]! @derivedFrom(field: "pool")
  swaps: [Swap!]! @derivedFrom(field: "pool")
  collects: [Collect!]! @derivedFrom(field: "pool")
  ticks: [Tick!]! @derivedFrom(field: "pool")
  positions: [Position!]! @derivedFrom(field: "pool")
}

type Tick {
  # format: <pool address>#<tick index>
  id: ID!
  # pool address
  poolAddress: String @index
  # tick index
  tickIdx: BigInt! @index
  # pointer to pool
  pool: Pool! @index
  # total liquidity pool has as tick lower or upper
  liquidityGross: BigInt!
  # how much liquidity changes when tick crossed
  liquidityNet: BigInt!
  # fee growth on the other side of this tick (relative to the current tick)
  feeGrowthOutside0X128: BigInt!
  # fee growth on the other side of this tick (relative to the current tick)
  feeGrowthOutside1X128: BigInt!
  # number of positions referencing this tick
  positionCount: BigInt!
  # created time
  createdAtTimestamp: Int! @index
  # created block
  createdAtBlockNumber: Int! @index
}

type LiquidityProvider {
  # format: <chainId>-<pool address>-<liquidity provider address>
  id: ID!
  # tokens deposited in token0 across all positions
  deposited0: BigInt!
  # tokens deposited in token1 across all positions
  deposited1: BigInt!
  # tokens collected in token0 across all positions
  collected0: BigInt!
  # tokens collected in token1 across all positions
  collected1: BigInt!
  # accrued fees in token0 across all positions
  fees0: BigInt!
  # accrued fees in token1 across all positions
  fees1: BigInt!
  # tokens owed to position owner in token0 (fees + withdrawn tokens not yet collected)
  tokensOwed0: BigInt!
  # tokens owed to position owner in token1 (fees + withdrawn tokens not yet collected)
  tokensOwed1: BigInt!
  # number of positions owned by this LP
  positionCount: BigInt!
  # number of pools this LP has provided liquidity to
  poolCount: BigInt!
  # total number of mints across all positions
  mintCount: BigInt!
  # total number of burns across all positions
  burnCount: BigInt!
  # total number of collects across all positions
  collectCount: BigInt!
  # timestamp when LP first provided liquidity
  createdAtTimestamp: Int! @index
  # block number when LP first provided liquidity
  createdAtBlockNumber: Int! @index
  # derived relationship to positions
  positions: [Position!]! @derivedFrom(field: "liquidityProvider")
}

type Position {
  # format: <pool address>#<owner>#<tickLower>#<tickUpper>
  id: ID!
  # owner of the position
  owner: Bytes! @index
  # liquidity provider entity
  liquidityProvider: LiquidityProvider! @index
  # pool position is within
  pool: Pool! @index
  # allow indexing by tokens
  token0: Token! @index
  # allow indexing by tokens
  token1: Token! @index
  # lower tick of the position
  tickLower: BigInt! @index
  # upper tick of the position
  tickUpper: BigInt! @index
  # total position liquidity
  liquidity: BigInt!
  # amount of token0 deposited
  deposited0: BigInt!
  # amount of token1 deposited
  deposited1: BigInt!
  # amount of token0 withdrawn
  withdrawn0: BigInt!
  # amount of token1 withdrawn
  withdrawn1: BigInt!
  # collected fees in token0
  collected0: BigInt!
  # collected fees in token1
  collected1: BigInt!
  # accrued fees in token0
  fees0: BigInt!
  # accrued fees in token1
  fees1: BigInt!
  # tokens owed to position owner in token0 (fees + withdrawn tokens not yet collected)
  tokensOwed0: BigInt!
  # tokens owed to position owner in token1 (fees + withdrawn tokens not yet collected)
  tokensOwed1: BigInt!
  # fee growth inside position range for token0 at last update
  feeGrowthInside0LastX128: BigInt!
  # fee growth inside position range for token1 at last update
  feeGrowthInside1LastX128: BigInt!
  # number of times liquidity was added
  mintCount: BigInt!
  # number of times liquidity was removed
  burnCount: BigInt!
  # number of times fees were collected
  collectCount: BigInt!
  # transaction in which position was initialized
  transaction: Transaction!
  # created time
  createdAtTimestamp: Int! @index
  # created block
  createdAtBlockNumber: Int! @index
}

type Transaction {
  # txn hash
  id: ID!
  # block txn was included in
  blockNumber: Int! @index
  # timestamp txn was confirmed
  timestamp: Int! @index
  # gas used during txn execution
  gasUsed: BigInt!
  gasPrice: BigInt!
  # derived values
  mints: [Mint!]! @derivedFrom(field: "transaction")
  burns: [Burn!]! @derivedFrom(field: "transaction")
  swaps: [Swap!]! @derivedFrom(field: "transaction")
  collects: [Collect!]! @derivedFrom(field: "transaction")
}

type Mint {
  # transaction hash + "#" + index in mints Transaction array
  id: ID!
  # which txn the mint was included in
  transaction: Transaction!
  # time of txn
  timestamp: Int! @index
  # pool position is within
  pool: Pool! @index
  # allow indexing by tokens
  token0: Token! @index
  # allow indexing by tokens
  token1: Token! @index
  # owner of position where liquidity minted to
  owner: Bytes! @index
  # the address that minted the liquidity
  sender: Bytes @index
  # txn origin
  origin: Bytes! @index # the EOA that initiated the txn
  # amount of liquidity minted
  amount: BigInt!
  # amount of token 0 minted
  amount0: BigInt!
  # amount of token 1 minted
  amount1: BigInt!
  # lower tick of the position
  tickLower: BigInt! @index
  # upper tick of the position
  tickUpper: BigInt! @index
  # order within the txn
  logIndex: Int
}

type Burn {
  # transaction hash + "#" + index in mints Transaction array
  id: ID!
  # txn burn was included in
  transaction: Transaction!
  # pool position is within
  pool: Pool! @index
  # allow indexing by tokens
  token0: Token! @index
  # allow indexing by tokens
  token1: Token! @index
  # need this to pull recent txns for specific token or pool
  timestamp: Int! @index
  # owner of position where liquidity was burned
  owner: Bytes @index
  # txn origin
  origin: Bytes! @index # the EOA that initiated the txn
  # amouny of liquidity burned
  amount: BigInt!
  # amount of token 0 burned
  amount0: BigInt!
  # amount of token 1 burned
  amount1: BigInt!
  # lower tick of position
  tickLower: BigInt! @index
  # upper tick of position
  tickUpper: BigInt! @index
  # position within the transactions
  logIndex: Int
}

type Swap {
  # transaction hash + "#" + index in swaps Transaction array
  id: ID!
  # pointer to transaction
  transaction: Transaction!
  # timestamp of transaction
  timestamp: Int! @index
  # pool swap occured within
  pool: Pool! @index
  # allow indexing by tokens
  token0: Token! @index
  # allow indexing by tokens
  token1: Token! @index
  # sender of the swap
  sender: Bytes! @index
  # recipient of the swap
  recipient: Bytes! @index
  # txn origin
  origin: Bytes! @index # the EOA that initiated the txn
  # delta of token0 swapped
  amount0: BigInt!
  # delta of token1 swapped
  amount1: BigInt!
  # The sqrt(price) of the pool after the swap, as a Q64.96
  sqrtPriceX96: BigInt!
  # the tick after the swap
  tick: BigInt! @index
  # index within the txn
  logIndex: Int
}

type Collect {
  # transaction hash + "#" + index in collect Transaction array
  id: ID!
  # pointer to txn
  transaction: Transaction!
  # timestamp of event
  timestamp: Int! @index
  # pool collect occured within
  pool: Pool! @index
  # owner of position collect was performed on
  owner: Bytes @index
  # amount of token0 collected
  amount0: BigInt!
  # amount of token1 collected
  amount1: BigInt!
  # lower tick of position
  tickLower: BigInt! @index
  # uppper tick of position
  tickUpper: BigInt! @index
  # index within the txn
  logIndex: Int
}

# Data accumulated and condensed into day stats for each pool
type PoolDayData {
  # timestamp rounded to current day by dividing by 86400
  id: ID!
  # unix timestamp for start of the day
  startTimestamp: Int! @index
  # pointer to pool
  pool: Pool! @index
  # in range liquidity at end of period
  liquidity: BigInt!
  # current price tracker at end of period
  sqrtPriceX96: BigInt!
  # current tick at end of period
  tick: BigInt!
  # volume in token0
  volume0: BigInt!
  # volume in token1
  volume1: BigInt!
  # fees in token0
  fees0: BigInt!
  # fees in token1
  fees1: BigInt!
  # number of transactions during period
  txCount: BigInt!
  # number of swaps during period
  swapCount: BigInt!
  # number of mints during period
  mintCount: BigInt!
  # number of burns during period
  burnCount: BigInt!
  # number of collects during period
  collectCount: BigInt!
  # opening price of token0
  open_: BigInt!
  # high price of token0
  high: BigInt!
  # low price of token0
  low: BigInt!
  # close price of token0
  close: BigInt!
}

# hourly stats tracker for pool
type PoolHourData {
  # format: <pool address>-<timestamp>
  id: ID!
  # unix timestamp for start of hour
  startTimestamp: Int! @index
  # pointer to pool
  pool: Pool! @index
  # in range liquidity at end of period
  liquidity: BigInt!
  # current price tracker at end of period
  sqrtPriceX96: BigInt!
  # current tick at end of period
  tick: BigInt!
  # volume in token0
  volume0: BigInt!
  # volume in token1
  volume1: BigInt!
  # fees in token0
  fees0: BigInt!
  # fees in token1
  fees1: BigInt!
  # number of transactions during period
  txCount: BigInt!
  # number of swaps during period
  swapCount: BigInt!
  # number of mints during period
  mintCount: BigInt!
  # number of burns during period
  burnCount: BigInt!
  # number of collects during period
  collectCount: BigInt!
  # opening price of token0
  open_: BigInt!
  # high price of token0
  high: BigInt!
  # low price of token0
  low: BigInt!
  # close price of token0
  close: BigInt!
}

type TokenDayData {
  # token address concatendated with date
  id: ID!
  # timestamp rounded to current day by dividing by 86400
  date: Int! @index
  # pointer to token
  token: Token! @index
  # volume in token units
  volume: BigInt!
  # liquidity across all pools in token units
  tvl: BigInt!
  # number of transactions during period
  txCount: BigInt!
  # number of swaps during period
  swapCount: BigInt!
  # number of mints during periodmkejqsw
  mintCount: BigInt!
  # number of burns during period
  burnCount: BigInt!
  # number of collects during period
  collectCount: BigInt!
}

type TokenHourData {
  # token address concatendated with date
  id: ID!
  # unix timestamp for start of hour
  periodStartUnix: Int! @index
  # pointer to token
  token: Token! @index
  # volume in token units
  volume: BigInt!
  # liquidity across all pools in token units
  tvl: BigInt!
  # number of transactions during period
  txCount: BigInt!
  # number of swaps during period
  swapCount: BigInt!
  # number of mints during period
  mintCount: BigInt!
  # number of burns during period
  burnCount: BigInt!
  # number of collects during period
  collectCount: BigInt!
}
